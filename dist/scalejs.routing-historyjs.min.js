define("scalejs.routing-historyjs/history",["scalejs!core","history","scalejs.reactive"],function(a,b){"use strict";function c(a){return b.pushState(a.data,a.title,a.url)}function d(){return b.getState()}function e(a){return b.replaceState(a.data,a.title,a.url)}function f(){var c=a.reactive.Observable,e=a.reactive.Disposable;return c.createWithDisposable(function(a){b.Adapter.bind(window,"statechange",function(){a.onNext(d())});return e.create(function(){window.onstatechange=null})}).publishValue(d()).refCount()}return{add:c,get:d,replace:e,observe:f}}),define("scalejs.routing-historyjs/routing",["scalejs!core","./history","scalejs.statechart-scion","scalejs.reactive"],function(a,b){"use strict";function c(){return b.observe().select(g)}function d(a){return"/"===a||"?"===a||""===a}function e(a){var b="?"+a.path.join("/");return n(a.parameters)&&(b+="?"+Object.keys(a.parameters).map(function(b){return b+"="+a.parameters[b]}).join("&")),b}function f(a){var b=a.replace("/?",""),c=d(b)?[[""]]:b.split("?").filter(function(a){return""!==a}).map(function(a,b){return 0===b?a.split("/"):a.split("&")});return{path:c[0],parameters:n(c[1])?c[1].reduce(function(a,b){var c=b.split("=");return a[c[0]]=c[1],a},{}):void 0}}function g(a){var b=a.hash.replace(l,""),c=f(b);return p(c,{url:e(c),timestamp:(new Date).getTime()})}function h(a){return o(a,"string")?a.replace("{","").replace("}",""):a}function i(a){var b=f(a);return w(function(a){var c;z[a.id]=b,c=r("routed",function(a){return a.data.path[0]===b.path[0]?(b.path.slice(1).forEach(function(b,c){a.data[h(b)]=a.data.path[c+1]}),a.data=p(a.data,a.data.parameters),!0):!1},s(a.id)),m?x(m,c):A.push(c)})}function j(a){B?(B=!1,b.replace({url:e(a)})):b.add({url:e(a)})}function k(b,d){function e(){function a(a){return a===b}var b;i.add(y().subscribe(function(a){var b;n(z,a.state)&&"entry"===a.event&&(b=z[a.state],b.path=b.path.map(function(b){var c=b.match(/[^{}]+(?=\})/);return n(c)?a.currentEvent.data[c[0]]:b}),n(b.parameters)&&Object.keys(b.parameters).forEach(function(c){b.parameters[c]=a.currentEvent.data[h(b.parameters[c])]}),j(b))})),i.add(c().subscribe(function(c){a(c.url)||(b=c.url,v("routed",{path:c.path,parameters:c.parameters},0))}))}var f,g,i=new a.reactive.CompositeDisposable;return m=b,n(d,"baseUrl")?(l=d.baseUrl,g=q(arguments).slice(2,arguments.length)):g=q(arguments).slice(1,arguments.length),f=u.apply(null,[b,r("router.disposing",s("router.disposed")),u("router.waiting",t(e)),u("router.disposed",t(function(){i.dispose(),z={},A=[]}))].concat(A).concat(g))}var l,m,n=a.object.has,o=a.type.is,p=a.object.merge,q=a.array.toArray,r=a.state.builder.on,s=a.state.builder.gotoInternally,t=a.state.builder.onEntry,u=a.state.builder.state,v=a.state.raise,w=a.functional.builder.$yield,x=a.state.registerTransition,y=a.state.observe,z={},A=[],B=!0;return{route:i,routerState:k}}),define("scalejs.routing-historyjs",["scalejs!core","./scalejs.routing-historyjs/routing"],function(a,b){"use strict";a.registerExtension({routing:b})});