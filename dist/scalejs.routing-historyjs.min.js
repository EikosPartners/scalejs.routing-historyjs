define("scalejs.routing-historyjs/history",["scalejs!core","history","rx"],function(a,b,c){"use strict";function d(a){return b.pushState(a.data,a.title,a.url)}function e(){return b.getState()}function f(a){return b.replaceState(a.data,a.title,a.url)}function g(){var a=c.Observable,d=c.Disposable;return a.createWithDisposable(function(a){return b.Adapter.bind(window,"statechange",function(){a.onNext(e())}),d.create(function(){window.onstatechange=null})}).publishValue(e()).refCount()}return{add:d,get:e,replace:f,observe:g}}),define("scalejs.routing-historyjs/routeMapper",["scalejs!core"],function(a){"use strict";var b=a.object.clone;return function(a){function c(){var b,c;f=a.replace(/^\/*|[/?]*$/g,""),b=f.match(/{([^}])*}/g),b&&(h=b.map(function(a){return a.replace(/[{}]/g,"")})),c="^[/]*"+f.replace(/{[^}]*}/g,"(.+?)")+"[?/]*$",g=new RegExp(c)}function d(a){var b,c,d,e,f={};return b=a.split(/\/*\?/),c=b[0],d=a.substring(c.length).replace(/^[?/]*/,""),e=c.match(g),null===e?null:(e.shift(),e.forEach(function(a,b){f[h[b]]=a}),d.split("&").map(function(a){var b=a.split("="),c=b[0],d=b[1];c&&(f[c]=d)}),f)}function e(a){a=a?b(a):{};var c,d={};return c=h.reduce(function(b,c){var d=b.replace("{"+c+"}",a[c]);return delete a[c],d},f),d=Object.keys(a).map(function(b){return b+"="+a[b]}).join("&"),"/"+c+(d?"?"+d:"")}var f,g,h=[];return c(),{fromUrl:d,toUrl:e}}}),define("scalejs.routing-historyjs/router",["./routeMapper"],function(a){"use strict";function b(b,c){var d=a(c);f[b]=d}function c(a,b){var c,d;if(!(b.indexOf(g)<0))return b=b.substring(g.length),c=f[a],c?d=c.fromUrl(b):void 0}function d(a,b){var c,d;return c=f[a],c?(d=c.toUrl(b),g+d):void 0}function e(a){g=a||"",g=g.replace(/\/*$/,"")}var f={},g="";return{addRoute:b,tryToUrl:d,tryFromUrl:c,setBaseUrl:e}}),define("scalejs.routing-historyjs/routing",["scalejs!core","./history","./router","rx","scalejs.statechart-scion"],function(a,b,c,d){"use strict";function e(a){x?(x=!1,b.replace({url:a})):b.add({url:a})}function f(){var a;w.add(u().subscribe(function(a){var b;"entry"===a.event&&(b=c.tryToUrl(a.state,a.currentEvent?a.currentEvent.data:null),b&&e(b))})),w.add(b.observe().subscribe(function(b){var c=b.hash;a!==c&&(a=c,r("routed",{url:c},0))}))}function g(){w.dispose()}function h(a){return s(function(b){var d;c.addRoute(b.id,a),d=n("routed",function(a){var d=c.tryFromUrl(b.id,a.data.url);return d?(l(a.data,d),!0):void 0},o(b.id)),j?t(j,d):v.push(d)})}function i(a,b){var d,e;return j=a,k(b,"baseUrl")?(c.setBaseUrl(b.baseUrl),d=m(arguments).slice(2,arguments.length)):d=m(arguments).slice(1,arguments.length),e=q.apply(null,[j,n("router.disposing",o("router.disposed")),q("router.waiting",p(f)),q("router.disposed",p(g))].concat(v).concat(d))}var j,k=a.object.has,l=a.object.extend,m=a.array.toArray,n=a.state.builder.on,o=a.state.builder.gotoInternally,p=a.state.builder.onEntry,q=a.state.builder.state,r=a.state.raise,s=a.functional.builder.$yield,t=a.state.registerTransition,u=a.state.observe,v=[],w=new d.CompositeDisposable,x=!0;return{route:h,routerState:i}}),define("scalejs.routing-historyjs",["scalejs!core","./scalejs.routing-historyjs/routing"],function(a,b){"use strict";a.registerExtension({routing:b})});